CREATE DATABASE AYAAN_COMMONMODULE

USE AYAAN_COMMONMODULE

CREATE TABLE STUDENTS(
STUDENTID VARCHAR(20),
FIRSTNAME VARCHAR(20),
LASTNAME VARCHAR(20),
AGE INT,
SPECIALIZATIONID VARCHAR(20)
)

CREATE TABLE SPECIALIZATION(
SPECIALIZATIONID VARCHAR(20),
SPECIALIZATION_NAME VARCHAR(30)
)

CREATE TABLE COURSES(
COURSEID VARCHAR(20),
COURSENAME VARCHAR(30),
CREDITS INT
)

CREATE TABLE ENROLLMENT(
ENROLLID VARCHAR(20),
STUDENTID VARCHAR(20),
COURSEID VARCHAR(20),
GRADE VARCHAR(20)
)

INSERT INTO STUDENTS VALUES
('STUD001','AYAAN','CHUDESARA',21,'SPEC001'),
('STUD002','PIYUSH','RATHWA',20,'SPEC001'),
('STUD003','KRUPESH','BANE',22,'SPEC002'),
('STUD004','HAMZA','ALI',21,'SPEC003'),
('STUD005','NADEEM','TURAB',20,'SPEC004'),
('STUD006','DEV','RAJPUT',21,'SPEC005'),
('STUD007','PARTH','PATEL',21,'SPEC006')

INSERT INTO SPECIALIZATION VALUES
('SPEC001','FS-JAVA'),
('SPEC002','FS-.NET'),
('SPEC003','DA'),
('SPEC004','DE'),
('SPEC005','DS'),
('SPEC006','QA')

INSERT INTO COURSES VALUES
('C001','SQL',5),
('C002','C',3),
('C003','JAVA',10),
('C004','CLOUD',5),
('C005','AI/ML',5)

INSERT INTO ENROLLMENT VALUES
('E001','STUD001','C001','A'),
('E002','STUD001','C002','B'),
('E003','STUD002','C001','B'),
('E004','STUD002','C002','C'),
('E005','STUD003','C005','A'),
('E006','STUD004','C003','F'),
('E007','STUD005','C001','C'),
('E008','STUD003','C004','B'),
('E009','STUD001','C003','A'),
('E010','STUD001','C004','B'),
('E011','STUD001','C005','B')

TRUNCATE TABLE ENROLLMENT


--1. Retrieve the names of students and their corresponding Specialization names.
SELECT FIRSTNAME,LASTNAME,SPECIALIZATION_NAME FROM STUDENTS AS S JOIN SPECIALIZATION AS S1 ON S.SPECIALIZATIONID=S1.SPECIALIZATIONID

--2. Find the names of students who have enrolled in all courses offered by the university. 
SELECT S.FIRSTNAME,S.LASTNAME,E.COURSEID FROM STUDENTS AS S JOIN ENROLLMENT AS E ON S.STUDENTID=E.STUDENTID
WHERE E.COURSEID='C001'  AND E.COURSEID = 'C002' AND E.COURSEID = 'C003' AND E.COURSEID = 'C004' AND E.COURSEID='C005'

--3. Retrieve the list of students along with the courses they are enrolled in and their grades.  
SELECT FIRSTNAME,LASTNAME,E.COURSEID,E.GRADE FROM STUDENTS AS S JOIN ENROLLMENT AS E ON S.STUDENTID=E.STUDENTID

--4. Find the names of students who have never received a grade lower than ‘B’ in any course. 
SELECT FIRSTNAME,LASTNAME,E.COURSEID,E.GRADE FROM STUDENTS AS S JOIN ENROLLMENT AS E ON S.STUDENTID=E.STUDENTID
WHERE E.GRADE < 'C'

--5. Retrieve the list of Specialization along with the number of students enrolled in each Specialization. 
SELECT SPECIALIZATION_NAME,COUNT(STUDENTID) AS NUM_STUDENTS FROM SPECIALIZATION AS S JOIN STUDENTS AS S1 ON S.SPECIALIZATIONID=S.SPECIALIZATIONID
WHERE S.SPECIALIZATIONID=S1.SPECIALIZATIONID GROUP BY SPECIALIZATION_NAME

--6. Find the names of students who have received an 'A' grade in any course.
SELECT FIRSTNAME,LASTNAME,E.COURSEID,E.GRADE FROM STUDENTS AS S JOIN ENROLLMENT AS E ON S.STUDENTID=E.STUDENTID
WHERE E.GRADE < 'B'

--7. Retrieve the list of courses along with the total number of credits for students enrolled in each course. 
SELECT COURSENAME,C.COURSEID,STUDENTID,C.CREDITS FROM COURSES AS C JOIN ENROLLMENT AS E ON C.COURSEID=E.COURSEID

--8. Find the names of students who are enrolled in both 'AI/ML' and 'Cloud Tech'. 
SELECT FIRSTNAME,LASTNAME,E.COURSEID,C.COURSENAME FROM STUDENTS AS S JOIN ENROLLMENT AS E ON S.STUDENTID=E.STUDENTID
JOIN COURSES AS C ON E.COURSEID=C.COURSEID
WHERE E.COURSEID IN ('C004','C005') 

--9. Retrieve the names of students along with their Specialization names and the courses they are enrolled in.
SELECT FIRSTNAME,LASTNAME,S1.SPECIALIZATION_NAME,C.COURSENAME FROM STUDENTS AS S JOIN ENROLLMENT AS E ON S.STUDENTID=E.STUDENTID
JOIN COURSES AS C ON E.COURSEID=C.COURSEID JOIN SPECIALIZATION AS S1 ON S.SPECIALIZATIONID=S1.SPECIALIZATIONID

--10. Retrieve the list of students along with their specialization names and the total number of credits they have enrolled.
SELECT FIRSTNAME,LASTNAME,S1.SPECIALIZATION_NAME,C.CREDITS FROM STUDENTS AS S JOIN SPECIALIZATION AS S1 ON S.SPECIALIZATIONID=S1.SPECIALIZATIONID
JOIN ENROLLMENT AS E ON S.STUDENTID=E.STUDENTID 
JOIN COURSES AS C ON E.COURSEID=C.COURSEID