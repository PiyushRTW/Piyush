CREATE DATABASE SQL_TEST
USE SQL_TEST

CREATE TABLE EMP (
EMPLOYEEID VARCHAR(30) PRIMARY KEY,
FIRSTNAME VARCHAR(20),
LASTNAME VARCHAR(20),
DEPARTMENTID VARCHAR(30),
SALARY MONEY CHECK(SALARY>=0),
HIREDATE DATE NOT NULL )

INSERT INTO EMP VALUES
('E01','SURESH','PATEL','D01',30000,'2002-03-01'),
('E02','MAHESH','PATEL','D01',45000,'2002-04-02'),
('E03','JIGNESH','SHAH','D02',40000,'2005-06-28'),
('E04','RAMESH','BHATT','D02',90000,'2003-06-01'),
('E05','KRUPESH','BANE','D03',20000,'2002-03-01'),
('E06','DEV','PATEL','D01',70000,'2002-03-01'),
('E07','UTKARSH','PATEL','D04',30000,'2001-01-05'),
('E08','NADIM','TURAB','D05',25000,'2002-01-07'),
('E09','PIYUSH','SHAH','D06',50000,'2012-06-01'),
('E10','JOHN','SMITH','D07',40000,'2022-07-01'),
('E11','PAVAN','PATEL','D01',45000,'2020-06-01'),
('E12','HAMZA','ALI','D01',60000,'2024-07-01'),
('E13','TIRTH','PANDYA','D04',70000,'2023-07-01'),
('E14','TRISHA','PATEL','D01',90000,'2000-02-01'),
('E15','RISHITA','SHAH','D07',500000,'2022-07-01'),
('E16','YELENA','HAANS','D01',300000,'2003-07-01'),
('E17','YAMINA','HAANS','D01',30000,'2003-04-01'),
('E18','AYAAN','CHUDESARA','D01',70000,'2002-06-01'),
('E19','YASH','PATEL','D01',45000,'2000-07-01'),
('E20','YASH','SHAH','D01',30000,'2005-07-01')

TRUNCATE TABLE EMP
SELECT * FROM EMP ORDER BY HIREDATE DESC
SELECT AVG(SALARY) FROM EMP

--1. Write a query to find all employees whose salary is greater than the average salaryof all employees.
SELECT EMPLOYEEID,FIRSTNAME,LASTNAME,AVG(SALARY) AS AVG_SALARY FROM EMP WHERE SALARY>(SELECT AVG(SALARY) FROM EMP) GROUP BY EMPLOYEEID,FIRSTNAME,LASTNAME  

--2. Write a query to find the total number of employees hired in each year.
SELECT HIREDATE,COUNT(EMPLOYEEID) AS TOTAL_EMP FROM EMP GROUP BY HIREDATE 

--3. Write a query to find the average salary of employees in each department, 
--but only include departments with more than 5 employees
SELECT DEPARTMENTID,AVG(SALARY) AS AVG_SALARY FROM EMP GROUP BY  DEPARTMENTID HAVING COUNT(EMPLOYEEID)>5

--4. Write a query to find all employees who were hired in the last 3 years and have a salary greater than 50,000.
SELECT TOP 3 HIREDATE,FIRSTNAME,LASTNAME,EMPLOYEEID,SALARY FROM EMP WHERE SALARY>50000 ORDER BY HIREDATE DESC 

--5. Write a query to find the total salary paid to employees in each department, but only
--include departments where the total salary is greater than 500,000.
SELECT DEPARTMENTID,SUM(SALARY) AS TOTAL_SALARY FROM EMP GROUP BY DEPARTMENTID HAVING SUM(SALARY)>500000 

--6. Write a query to find departments with more than 10 employees.
SELECT DEPARTMENTID,COUNT(EMPLOYEEID) AS TOTAL FROM EMP GROUP BY DEPARTMENTID HAVING COUNT(EMPLOYEEID)>10

--7. Write a query to find employees who have been with the company for more than 10 years 
--and have a salary greater than 60,000.
SELECT EMPLOYEEID,FIRSTNAME,LASTNAME,HIREDATE FROM EMP WHERE HIREDATE<'2015-02-14' AND SALARY >60000

--8. Write a query to find departments with an average salary greater than 70,000.
SELECT DEPARTMENTID,AVG(SALARY) AS AVG_SALARY FROM EMP GROUP BY DEPARTMENTID HAVING AVG(SALARY) > 70000

--9. Write a query to find the total number of employees in each department.
SELECT DEPARTMENTID,COUNT(EMPLOYEEID) AS TOTAL FROM EMP GROUP BY DEPARTMENTID 

--10. Write a query to find the highest salary among all employees.
SELECT EMPLOYEEID,FIRSTNAME,LASTNAME,SALARY FROM EMP WHERE SALARY=(SELECT MAX(SALARY) FROM EMP)
